# CWE-798: Use of Hard-coded Credentials

## Description
Hard-coded credentials in source code pose serious security risks as they can be discovered through code review, decompilation, or version control history.

## Remediation Techniques

### 1. Environment Variables (Recommended)
Store credentials in environment variables.

**Python:**
```python
import os

# BAD: Hard-coded credentials
username = "admin"
password = "password123"

# GOOD: Use environment variables
username = os.environ.get('DB_USERNAME')
password = os.environ.get('DB_PASSWORD')

if not username or not password:
    raise ValueError("Credentials not configured")
```

### 2. Configuration Files (with proper permissions)
Use configuration files outside the source code repository.

**Python:**
```python
import json

# Load from config file (not in version control)
with open('/etc/myapp/config.json') as f:
    config = json.load(f)

username = config['database']['username']
password = config['database']['password']
```

### 3. Secret Management Systems
Use dedicated secret management tools.

**Python (AWS Secrets Manager):**
```python
import boto3
from botocore.exceptions import ClientError

def get_secret():
    client = boto3.client('secretsmanager')
    try:
        response = client.get_secret_value(SecretId='myapp/db/credentials')
        return json.loads(response['SecretString'])
    except ClientError as e:
        raise e

credentials = get_secret()
```

**Python (HashiCorp Vault):**
```python
import hvac

client = hvac.Client(url='http://localhost:8200')
client.token = os.environ['VAULT_TOKEN']

secret = client.secrets.kv.v2.read_secret_version(
    path='database/credentials'
)

username = secret['data']['data']['username']
password = secret['data']['data']['password']
```

### 4. Use dotenv for Development
For development environments, use python-dotenv:

**Python:**
```python
from dotenv import load_dotenv
import os

load_dotenv()  # Load from .env file

username = os.getenv('DB_USERNAME')
password = os.getenv('DB_PASSWORD')
```

**.env file (add to .gitignore):**
```
DB_USERNAME=admin
DB_PASSWORD=secure_password_here
```

### 5. Key Rotation
- Regularly rotate credentials
- Use temporary credentials when possible
- Implement credential expiration

## Key Points
- NEVER hard-code credentials in source code
- Use environment variables or secret management systems
- Keep configuration files out of version control (.gitignore)
- Implement proper file permissions (e.g., 600 for config files)
- Use different credentials for different environments
- Rotate credentials regularly
- Consider using managed identity or IAM roles when available
